1、理解CAP
------

CAP是Consistency、Availability、Partition tolerance三个词语的缩写，分别表示**一致性、可用性、分区容忍性**。

为了方便更好的理解CAP定理，我这里使用电商系统商品管理系统来解释执行流程如下:
* 1、商品服务请求主数据库写入商品信息（添加商品、修改商品、删除商品）
* 2、主数据库向商品服务响应写入成功
* 3、商品服务请求从数据库读取商品信息

2、一致性（C - Consistency）
-------

一致性是指写操作后的读操作可以读取到最新的数据状态，当数据分布在多个节点上，从任意节点读取到的数据都是最新的状态。商品信息的读写要满足一致性就是要满足如下目标：

* 1、商品服务写入主数据库成功，则向从数据库查询新数据也成功。
* 2、商品服务写入主数据库失败，则向从数据库查询新数据也失败。

**如何实现一致性**？

* 1、写入主数据库后要将数据同步到数据库。
* 2、写入主数据库后，在向从数据库同步期间要将从数据库锁定，待同步完成后再释放锁，以免在新数据写入成功后，向从数据库查询到旧数据

**一致性的特点**

* 1、由于存在数据同步的过程，写操作的响应会有一定的延迟。
* 2、为了保证数据一致性会对资源暂时锁定，待数据同步完成释放锁定资源。
* 3、如果请求数据同步失败的节点则会返回错误信息，一定不会返回旧数据。

3、可用性（A - Availability）
-----

可用性是指任何事物操作都可以得到相应结果，且不会出现相应超时或相应错误。商品信息读取满足可用性就是要实现如下目标：

* 从节点数据库接收到查询数据的请求则立即能够相应数据查询结果。

* 从节点数据库允许出现响应超时或者相应出错。

**如何实现可用性**？

* 1、写入主数据库后将数据同步到从节点数据库

* 2、由于要保证从数据库的可用性，不可将从数据库资源的资源锁定。

* 3、即使数据还没有从主节点数据库同步到从节点数据库，从节点数据库查询也要返回数据，哪怕是旧数据，如果连旧数据也没有则可以提前约定返回一个默认信息，但不能返回错误或者相应超时。

4、分区容错性（P -Partition tolerance）
------
